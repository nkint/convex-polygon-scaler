{"version":3,"file":"polygon-scaler.js","sources":["../src/index.ts"],"sourcesContent":["import { partition, wrap, zip } from '@thi.ng/transducers'\nimport { intersectLineLine } from '@thi.ng/geom-isec'\nimport { Vec } from '@thi.ng/vectors'\nimport { isArray } from '@thi.ng/checks'\n\nfunction edgeOrLineIterator<T>(items: Iterable<T>) {\n  return partition(2, 1, wrap(items, 1, false, true)) as Iterable<[T, T]>\n}\n\nexport function polygonScaler(polygon: Vec[], distance: number | number[]) {\n  if (isArray(distance) && distance.length !== polygon.length) {\n    throw new Error('Distances length must be the same length of the polygon.')\n  }\n  const distances = !isArray(distance) ? polygon.map(_ => distance) : distance\n\n  const lines: [Vec, Vec][] = [...edgeOrLineIterator(polygon)]\n  const angles = lines.map(l => Math.atan2(l[1][1] - l[0][1], l[1][0] - l[0][0]))\n  const linesInDistance: [Vec, Vec][] = [...zip(lines, angles, distances)].reduce(\n    (acc, [line, angle, distance], i) => {\n      const p1 = [-distance * Math.sin(angle) + line[0][0], distance * Math.cos(angle) + line[0][1]]\n      const p2 = [-distance * Math.sin(angle) + line[1][0], distance * Math.cos(angle) + line[1][1]]\n      acc.push([p1, p2])\n      return acc\n    },\n    [],\n  )\n  const intersections = [...edgeOrLineIterator(linesInDistance)].map(\n    ([line1, line2]) => intersectLineLine(line1[0], line1[1], line2[0], line2[1]).isec as Vec,\n  )\n  return intersections\n}\n"],"names":["edgeOrLineIterator","items","partition","wrap","polygon","distance","isArray","length","Error","distances","map","_","lines","angles","l","Math","atan2","linesInDistance","zip","reduce","acc","ref","i","p1","sin","angle","line","cos","p2","push","intersectLineLine","line1","line2","isec"],"mappings":"gGAKA,SAASA,EAAsBC,UACtBC,YAAU,EAAG,EAAGC,OAAKF,EAAO,GAAG,GAAO,mCAGjBG,EAAgBC,MACxCC,UAAQD,IAAaA,EAASE,SAAWH,EAAQG,aAC7C,IAAIC,MAAM,gEAEZC,EAAaH,UAAQD,GAAyCA,EAA7BD,EAAQM,aAAIC,UAAKN,IAElDO,EAAsB,UAAIZ,EAAmBI,IAC7CS,EAASD,EAAMF,aAAII,UAAKC,KAAKC,MAAMF,EAAE,GAAG,GAAKA,EAAE,GAAG,GAAIA,EAAE,GAAG,GAAKA,EAAE,GAAG,MACrEG,EAAgC,UAAIC,MAAIN,EAAOC,EAAQJ,IAAYU,gBACtEC,EAAKC,EAAyBC,4BACvBC,EAAK,EAAElB,EAAWU,KAAKS,IAAIC,GAASC,EAAK,GAAG,GAAIrB,EAAWU,KAAKY,IAAIF,GAASC,EAAK,GAAG,IACrFE,EAAK,EAAEvB,EAAWU,KAAKS,IAAIC,GAASC,EAAK,GAAG,GAAIrB,EAAWU,KAAKY,IAAIF,GAASC,EAAK,GAAG,WAC3FN,EAAIS,KAAK,CAACN,EAAIK,IACPR,GAET,UAEoB,UAAIpB,EAAmBiB,IAAkBP,aAC5DW,4BAAmBS,oBAAkBC,EAAM,GAAIA,EAAM,GAAIC,EAAM,GAAIA,EAAM,IAAIC"}